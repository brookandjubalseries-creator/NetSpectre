<Window x:Class="NetSpectre.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="NetSpectre Settings"
        Height="620" Width="520"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Style="{StaticResource DarkWindowStyle}">

    <Grid Margin="16" TextOptions.TextFormattingMode="Display" TextOptions.TextRenderingMode="ClearType">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TabControl Grid.Row="0">
            <!-- Capture Settings -->
            <TabItem Header="Capture">
                <StackPanel Margin="12">
                    <TextBlock Text="Packet Capture Settings" FontSize="14" FontWeight="SemiBold"
                               Foreground="{StaticResource AccentBrush}" Margin="0,0,0,12" />

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="32" />
                            <RowDefinition Height="32" />
                            <RowDefinition Height="32" />
                            <RowDefinition Height="32" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Buffer Size:" VerticalAlignment="Center" />
                        <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding BufferSize}" FontSize="14" VerticalAlignment="Center" />

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Batch Interval (ms):" VerticalAlignment="Center" />
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding BatchIntervalMs}" FontSize="14" VerticalAlignment="Center" />

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Max Flush Per Tick:" VerticalAlignment="Center" />
                        <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding MaxFlushPerTick}" FontSize="14" VerticalAlignment="Center" />

                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Promiscuous Mode:" VerticalAlignment="Center" />
                        <CheckBox Grid.Row="3" Grid.Column="1" IsChecked="{Binding PromiscuousMode}" VerticalAlignment="Center" />
                    </Grid>
                </StackPanel>
            </TabItem>

            <!-- Detection Settings -->
            <TabItem Header="Detection">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12">
                        <!-- Port Scan -->
                        <TextBlock Text="Port Scan Detection" FontSize="14" FontWeight="SemiBold"
                                   Foreground="{StaticResource AccentBrush}" Margin="0,0,0,8" />
                        <CheckBox Content="Enabled" IsChecked="{Binding PortScanEnabled}" Margin="0,0,0,4" />
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="180" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="32" />
                                <RowDefinition Height="32" />
                                <RowDefinition Height="32" />
                                <RowDefinition Height="32" />
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Window (seconds):" VerticalAlignment="Center" />
                            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding PortScanWindowSeconds}" FontSize="14" VerticalAlignment="Center" />

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Info Threshold:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding PortScanInfoThreshold}" FontSize="14" VerticalAlignment="Center" />

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Warning Threshold:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding PortScanWarningThreshold}" FontSize="14" VerticalAlignment="Center" />

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Critical Threshold:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding PortScanCriticalThreshold}" FontSize="14" VerticalAlignment="Center" />
                        </Grid>

                        <!-- DNS Anomaly -->
                        <TextBlock Text="DNS Anomaly Detection" FontSize="14" FontWeight="SemiBold"
                                   Foreground="{StaticResource AccentBrush}" Margin="0,0,0,8" />
                        <CheckBox Content="Enabled" IsChecked="{Binding DnsAnomalyEnabled}" Margin="0,0,0,4" />
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="180" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="32" />
                                <RowDefinition Height="32" />
                                <RowDefinition Height="32" />
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Suspicious Entropy:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding DnsSuspiciousEntropy}" FontSize="14" VerticalAlignment="Center" />

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="High Entropy:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding DnsHighEntropy}" FontSize="14" VerticalAlignment="Center" />

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Critical Entropy:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding DnsCriticalEntropy}" FontSize="14" VerticalAlignment="Center" />
                        </Grid>

                        <!-- C2 Beacon -->
                        <TextBlock Text="C2 Beacon Detection" FontSize="14" FontWeight="SemiBold"
                                   Foreground="{StaticResource AccentBrush}" Margin="0,0,0,8" />
                        <CheckBox Content="Enabled" IsChecked="{Binding C2BeaconEnabled}" Margin="0,0,0,4" />
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="180" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="32" />
                                <RowDefinition Height="32" />
                                <RowDefinition Height="32" />
                                <RowDefinition Height="32" />
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Min Connections:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding C2MinConnections}" FontSize="14" VerticalAlignment="Center" />

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Critical CV Threshold:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding C2CriticalCvThreshold}" FontSize="14" VerticalAlignment="Center" />

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Warning CV Threshold:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding C2WarningCvThreshold}" FontSize="14" VerticalAlignment="Center" />

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="DBSCAN Cluster Ratio:" VerticalAlignment="Center" />
                            <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding C2DbscanClusterRatio}" FontSize="14" VerticalAlignment="Center" />
                        </Grid>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Visualization Settings -->
            <TabItem Header="Visualization">
                <StackPanel Margin="12">
                    <TextBlock Text="Graph Visualization" FontSize="14" FontWeight="SemiBold"
                               Foreground="{StaticResource AccentBrush}" Margin="0,0,0,12" />

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="32" />
                            <RowDefinition Height="32" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Max Nodes:" VerticalAlignment="Center" />
                        <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding MaxNodes}" FontSize="14" VerticalAlignment="Center" />

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Target FPS:" VerticalAlignment="Center" />
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding TargetFps}" FontSize="14" VerticalAlignment="Center" />
                    </Grid>
                </StackPanel>
            </TabItem>

            <!-- About -->
            <TabItem Header="About">
                <StackPanel Margin="12" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock Text="&#x25C8;" FontSize="48" Foreground="{StaticResource AccentBrush}"
                               HorizontalAlignment="Center" Margin="0,0,0,8" />
                    <TextBlock Text="NetSpectre" FontSize="24" FontWeight="Bold"
                               Foreground="{StaticResource AccentBrush}" HorizontalAlignment="Center" />
                    <TextBlock Text="Network Traffic Analyzer &amp; IDS" FontSize="13"
                               Foreground="{StaticResource TextSecondaryBrush}" HorizontalAlignment="Center"
                               Margin="0,4,0,20" />
                    <TextBlock Text="Version 1.0.0" HorizontalAlignment="Center"
                               Foreground="{StaticResource TextDimBrush}" />
                    <TextBlock Text=".NET 8 / WPF / SkiaSharp / SharpPcap" HorizontalAlignment="Center"
                               Foreground="{StaticResource TextDimBrush}" Margin="0,4,0,0" />
                </StackPanel>
            </TabItem>
        </TabControl>

        <!-- Bottom buttons -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="Reset Defaults" Command="{Binding ResetDefaultsCommand}"
                    Padding="16,6" Margin="0,0,8,0" />
            <Button Content="Cancel" Command="{Binding CancelCommand}"
                    Padding="16,6" Margin="0,0,8,0" Click="Cancel_Click" />
            <Button Content="Save" Command="{Binding SaveCommand}"
                    Padding="16,6" Click="Save_Click">
                <Button.Style>
                    <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding HasChanges}" Value="True">
                                <Setter Property="Foreground" Value="{StaticResource AccentBrush}" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>
        </StackPanel>
    </Grid>
</Window>
